<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seisflows3-super.solver.specfem3d_maui &mdash; SeisFlows3  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/sf3_globe_alpha.png"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> SeisFlows3
            <img src="../../../../_static/sf3_globe_alpha_wide.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../start_here.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citeme.html">Cite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Structure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../command_line_tool.html">Commmand Line Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../parameter_file.html">Parameter File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../working_directory.html">Working Directory Structure</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../specfem2d_example.html">Specfem2D workstation example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How To</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../extending.html">Extending SeisFlows3</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code_dev_plan.html">Code Development Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">SeisFlows3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">seisflows3-super.solver.specfem3d_maui</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/seisflows3super/solver/specfem3d_maui/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-seisflows3-super.solver.specfem3d_maui">
<span id="seisflows3-super-solver-specfem3d-maui"></span><h1><a class="reference internal" href="#module-seisflows3-super.solver.specfem3d_maui" title="seisflows3-super.solver.specfem3d_maui"><code class="xref py py-mod docutils literal notranslate"><span class="pre">seisflows3-super.solver.specfem3d_maui</span></code></a><a class="headerlink" href="#module-seisflows3-super.solver.specfem3d_maui" title="Permalink to this headline"></a></h1>
<p>This is the subclass seisflows.solver.Specfem3DMaui</p>
<p>This class is almost the same as Specfem3D, except the setup step is run as
a serial task. This is useful as HPC job queues are long on Maui, so it saves
on job queue time by replacing it with a long-winded serial task.</p>
<p>Additionally, misfit quantification is split off from the forward simulation,
because Anaconda is not available on the main cluster, so jobs need to be
submitted to an auxiliary cluster. This is paired with a new evaluate_function()
function defined by the InversionMaui workflow class.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui" title="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Specfem3DMaui</span></code></a></p></td>
<td><p>Python interface to Specfem3D Cartesian. This subclass inherits functions</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#seisflows3-super.solver.specfem3d_maui.PAR" title="seisflows3-super.solver.specfem3d_maui.PAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PAR</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seisflows3-super.solver.specfem3d_maui.PATH" title="seisflows3-super.solver.specfem3d_maui.PATH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PATH</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#seisflows3-super.solver.specfem3d_maui.system" title="seisflows3-super.solver.specfem3d_maui.system"><code class="xref py py-obj docutils literal notranslate"><span class="pre">system</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#seisflows3-super.solver.specfem3d_maui.preprocess" title="seisflows3-super.solver.specfem3d_maui.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py data">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.PAR">
<span class="sig-prename descclassname"><span class="pre">seisflows3-super.solver.specfem3d_maui.</span></span><span class="sig-name descname"><span class="pre">PAR</span></span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.PAR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.PATH">
<span class="sig-prename descclassname"><span class="pre">seisflows3-super.solver.specfem3d_maui.</span></span><span class="sig-name descname"><span class="pre">PATH</span></span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.PATH" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.system">
<span class="sig-prename descclassname"><span class="pre">seisflows3-super.solver.specfem3d_maui.</span></span><span class="sig-name descname"><span class="pre">system</span></span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.system" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.preprocess">
<span class="sig-prename descclassname"><span class="pre">seisflows3-super.solver.specfem3d_maui.</span></span><span class="sig-name descname"><span class="pre">preprocess</span></span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.preprocess" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seisflows3-super.solver.specfem3d_maui.</span></span><span class="sig-name descname"><span class="pre">Specfem3DMaui</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">custom_import</span></code>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">'solver'</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">'specfem3d'</span></code>)</p>
<p>Python interface to Specfem3D Cartesian. This subclass inherits functions
from seisflows3.solver.specfem3d</p>
<p>!!! See base class for method descriptions !!!</p>
<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.required">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.required" title="Permalink to this definition"></a></dt>
<dd><p>A hard definition of paths and parameters required by this class,
alongside their necessity for the class and their string explanations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.check" title="Permalink to this definition"></a></dt>
<dd><p>Checks parameters and paths</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.setup" title="Permalink to this definition"></a></dt>
<dd><p>Overload of solver.base.setup(), should be run as a single instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – “init”, “true”, generates the mesh to be used for workflow
“true” used for synthetic-synthetic cases
“init” for initial model, default</p></li>
<li><p><strong>model</strong> – model to setup, either ‘true’ or ‘init’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.generate_data">
<span class="sig-name descname"><span class="pre">generate_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.generate_data" title="Permalink to this definition"></a></dt>
<dd><p>Overload seisflows.solver.base.generate_data. To be run in parallel</p>
<p>Not used if PAR.CASE == “Data”</p>
<p>Generates data in the synthetic-synthetic comparison case.
Automatically calls generate mesh for the true model, rather than
passing them in as kwargs.</p>
<p>Also turns on attenuation for the forward model
!!! attenuation could be moved into parameters.yaml? !!!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.generate_mesh">
<span class="sig-name descname"><span class="pre">generate_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gll'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.generate_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Performs meshing and database generation as a serial task. Differs
slightly from specfem3d class as it only creates database files for
the main solver, which are then copied in serial by the function
distribute_databases()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – path to the model to be used for mesh generation</p></li>
<li><p><strong>model_name</strong> (<em>str</em>) – name of the model to be used as identification</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – available model types to be passed to the Specfem3D
Par_file. See Specfem3D Par_file for available options.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.eval_misfit">
<span class="sig-name descname"><span class="pre">eval_misfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.eval_misfit" title="Permalink to this definition"></a></dt>
<dd><p>Performs function evaluation only, that is, the misfit quantification.
Forward simulations are performed in a separate function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – path in the scratch directory to use for I/O</p></li>
<li><p><strong>export_traces</strong> (<em>bool</em>) – option to save the observation traces to disk</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.eval_fwd">
<span class="sig-name descname"><span class="pre">eval_fwd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.eval_fwd" title="Permalink to this definition"></a></dt>
<dd><p>High level solver interface</p>
<p>Performans forward simulations only, function evaluation is split off
into its own function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path in the scratch directory to use for I/O</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.distribute_databases">
<span class="sig-name descname"><span class="pre">distribute_databases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.distribute_databases" title="Permalink to this definition"></a></dt>
<dd><p>A serial task to distrubute the database files outputted by
xgenerate_databases from main solver to all other solver directories</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.initialize_solver_directories">
<span class="sig-name descname"><span class="pre">initialize_solver_directories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.initialize_solver_directories" title="Permalink to this definition"></a></dt>
<dd><p>Creates solver directories in serial using a single node.
Should only be run by master job.</p>
<p>Differs from Base initialize_solver_directories() as this serial task
will create directory structures for each source, rather than having
each source create its own. However the internal dir structure is the
same.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.check_solver_parameter_files">
<span class="sig-name descname"><span class="pre">check_solver_parameter_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.check_solver_parameter_files" title="Permalink to this definition"></a></dt>
<dd><p>Checks solver parameters. Only slightly different to Specfem3D as it
is run by the main task, not be an array process, so no need to check
task_id</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.mainsolver">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mainsolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seisflows3-super.solver.specfem3d_maui.Specfem3DMaui.mainsolver" title="Permalink to this definition"></a></dt>
<dd><p>Ensure that the main solver has a consistent reference inside Solver</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, SeisFlows3 Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>